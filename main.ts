enum ActionKind
{
    MoveRight,
    MoveLeft,
    Idle,
    Walking,
    Jumping
}

enum ActionKind_jk
{
    moveRight,
    moveLeft,
    idle,
    Walking,
    Jumping
}

enum EnemyKind
{
    Boss
}

let jk: jk_ch = null
let rowa: rowa_ch = null
let dango: dango_ch = null

let mainIdle = null
let mainRunLeft = null
let mainRunRight = null

let jkIdle = null
let jkRunLeft = null
let jkRunRight = null

let level = 0
let enemy_num = 0
let boss_num = 0
let turn = 0

let get_input: string[] = []
let boss_game: string[] = ["right","left","up","down","A","B"]
//let choose_boss_game: string[] = [boss_game[randint(0, 3)], boss_game[randint(0, 3)], boss_game[randint(0, 3)]]
let choose_boss_game: string[] = []
let jk_array_: jk_ch[] = []

// animation rowa
mainRunRight = animation.createAnimation(ActionKind.MoveRight, 200)
mainRunLeft = animation.createAnimation(ActionKind.MoveLeft, 200)
mainIdle = animation.createAnimation(ActionKind.Idle, 200)

// animation jk
/*jkRunRight = animation.createAnimation(ActionKind_jk.moveRight, 200)
jkRunLeft = animation.createAnimation(ActionKind_jk.moveLeft, 200)
jkIdle = animation.createAnimation(ActionKind_jk.idle, 200)*/

class character
{
    entity: Sprite = null
    GRAVITY: number = 294
    VELOCITY: number = 80
    constructor(entity: Sprite)
    {
        this.entity = entity
        this.entity.ay = this.GRAVITY
    }

    set_VELOCITY(VELOCITY: number)
    {
        controller.moveSprite(this.entity,VELOCITY,0)
    }
    
    jump(jump_val: number)
    {
        function func()
        {
            // if character is stand on the platform or ground can jump
            if (this.entity.vy == 0) 
            {
                this.entity.vy = jump_val
            }
            get_input.push("A")
        }
        return func
    }

    walk_right(main:any ,frame_1 : any, frame_2: any, frame_3: any = null)
    {
        function func()
        {
            animation.attachAnimation(this.entity, main)
            frame_1
            frame_2
            frame_3
            get_input.push("right")
        }
        console.log("I am walking to right")
        return func
    }

    walk_left(main:any ,frame_1 : any, frame_2: any, frame_3: any = null)
    {
        function func()
        {
            //mainRunLeft = animation.createAnimation(ActionKind.MoveLeft, 100)
            animation.attachAnimation(this.entity, main)
            frame_1
            frame_2
            frame_3
            get_input.push("left")
        }
        console.log("I am walking to left")
        return func
    }

    up()
    {
        function func()
        {
            get_input.push("up")
        }
        return func
    }

    down()
    {
        function func()
        {
            get_input.push("down")
        }
        return func
    }

    push_B()
    {
        function func()
        {
            get_input.push("B")
        }
        return func
    }

    idle(main:any, frame_1 : any)
    {
        function func()
        {
            //mainIdle = animation.createAnimation(ActionKind.Idle, 100)
            animation.attachAnimation(this.entity, main)
            frame_1
        }
        console.log("I stay idle")
        return func
    }
}

class rowa_ch extends character
{
    JUMP: number = -150
    constructor(entity: Sprite)
    {
        super(entity)
        controller.moveSprite(this.entity,this.VELOCITY,0)
        controller.A.onEvent(ControllerButtonEvent.Pressed,this.jump(this.JUMP))
    }

    set_JUMP(JUMP: number)
    {
        controller.A.onEvent(ControllerButtonEvent.Pressed,this.jump(JUMP))
    }

    next()
    {
        function func()
        {
            level += 1
            next_level()
            destroy(sprites.allOfKind(SpriteKind.Enemy))

        }
        return func
    }

    win()
    {
        function func()
        {
            game.over(true, effects.confetti)
        }
        return func
    }

    lose()
    {
        function func()
        {
            game.over(false, effects.melt)
        }
        return func
    }

}

class jk_ch extends character
{

    constructor(entity: Sprite)
    {
        super(entity)
        entity.ay = 0
    }

}

class dango_ch extends character
{ 

    constructor(entity: Sprite)
    {
        super(entity)
        entity.ay = 0
    }

}



// *******************creating character*******************
function create_rowa ()
{
    rowa = new rowa_ch(sprites.create(img`
        ................................
        ...........ffffffff.............
        .........ffffffffffff...........
        ........ffffffffffffff..........
        ........ffffff44444ffff.........
        ........ffff44444444fff.........
        .......ffff4444444444ff.........
        .......fff44fff44fff44f.........
        .......fff444ff444ff44f.........
        .......fff444444444444f.........
        .......fff444444444444f.........
        .......ffff4444444444ff.........
        .......fffff444fff44ff..........
        .......ffffff444444ff...........
        ........ffffff4444ff............
        .........fff.ffffff.............
        .........fff..f44f..............
        .........fffffffffff............
        ..........fffeeffeefff..........
        ..........feeeeeeeeeef..........
        ..........feefe88efeef..........
        ..........feefee8efeef..........
        ..........feefeeeefeef..........
        ..........f44feeeef44f..........
        ..........f44fff5ff44f..........
        ...........f4fbbbbf4f...........
        ............ffbbbbff............
        .............fbbbbf.............
        .............fbbfbf.............
        .............fbbfbf.............
        .............fffffff............
        .............feeefeef...........
    `, SpriteKind.Player))
}

function create_jk()
{
    let tiles_location = tiles.getTilesByType(myTiles.tile8)
    if( level <= 39 || (level >= 45 && level <= 48) )
    {
        if(level%10 >= 6 && level%10 < 9)
        {
            while(enemy_num < 5)
            {
                jk = new jk_ch(sprites.create(img`
                    ................................
                    ................................
                    ....................ff..........
                    ................fffff...........
                    ..............fff77f............
                    ..............f7fff.............
                    ............fff77ff.............
                    ...........ff77ff7fff...........
                    ....ffffffff77ff77f7ff..........
                    ...ff777777777ff77fffff.........
                    ...f77777777777777ff............
                    ....ffffffffff7777ff............
                    .............f7777ffff..........
                    ............fff777f77fff........
                    ....f......ff5f777ff7fff........
                    ....ffffffff555f777fff..........
                    ....ffbbbbbf555f777ff...........
                    ....ffffffff555f777ffff.........
                    ...........f555f777f77ff........
                    ...........ff5f77fffffff........
                    .....ffffffffff7fffff...........
                    ....f5aaaaaaafffaaffff..........
                    ....f5aaaaaaaaaaaaaaaff.........
                    ....ffffaaaaaaaaaaaaaaff........
                    ...ff222ffffffffffffffffffff....
                    ...ff222ff...........ff999ff....
                    ....fffff............fffffff....
                    ................................
                    ................................
                    ................................
                    ................................
                    ................................
                `, SpriteKind.Enemy))
                tiles.placeOnTile(jk.entity, tiles_location[enemy_num])
                tiles.setTileAt(tiles_location[enemy_num], myTiles.tile9)
                enemy_num += 1
                jk_array_.push(jk)
            }
        }

        else if(level%10 <= 5)
        {
            while(enemy_num < 2*((level)%10))
            {
                jk = new jk_ch(sprites.create(img`
                    ................................
                    ................................
                    ....................ff..........
                    ................fffff...........
                    ..............fff77f............
                    ..............f7fff.............
                    ............fff77ff.............
                    ...........ff77ff7fff...........
                    ....ffffffff77ff77f7ff..........
                    ...ff777777777ff77fffff.........
                    ...f77777777777777ff............
                    ....ffffffffff7777ff............
                    .............f7777ffff..........
                    ............fff777f77fff........
                    ....f......ff5f777ff7fff........
                    ....ffffffff555f777fff..........
                    ....ffbbbbbf555f777ff...........
                    ....ffffffff555f777ffff.........
                    ...........f555f777f77ff........
                    ...........ff5f77fffffff........
                    .....ffffffffff7fffff...........
                    ....f5aaaaaaafffaaffff..........
                    ....f5aaaaaaaaaaaaaaaff.........
                    ....ffffaaaaaaaaaaaaaaff........
                    ...ff222ffffffffffffffffffff....
                    ...ff222ff...........ff999ff....
                    ....fffff............fffffff....
                    ................................
                    ................................
                    ................................
                    ................................
                    ................................
                `, SpriteKind.Enemy))
                tiles.placeOnTile(jk.entity, tiles_location[enemy_num])
                tiles.setTileAt(tiles_location[enemy_num], myTiles.tile9)
                enemy_num += 1
                jk_array_.push(jk)
            }
        }
    }

    while(enemy_num < 10)
    {
        tiles.setTileAt(tiles_location[enemy_num], myTiles.tile9)
        enemy_num += 1
    }
}

function create_dango(level_: number)
{
    let tiles_location = tiles.getTilesByType(myTiles.tile23)
    if(boss_num == 0)
    {
        if(level_ == 9)
        {
            dango = new dango_ch(sprites.create(img`
                ..................................................
                ..................fffffffffffff...................
                ................ffbbbbbbbbbbbbbff.................
                ..............ffbbbbbbbbbbbbbbbbbff...............
                .............fbbbbbbbbbbbbbbbbbbbbbf..............
                ............fbbbbbbbbbbbbbbbbbbbbbbbf.............
                ...........fbbbbbbbbbbbbbbbbbbbbbbbbbf............
                ..........fbbbbbbbbbbbbbbbbbbbbbbbbbbbf...........
                .........fbbbbbbbbbbbbbbbbbbbbbbbbbbbbbf..........
                ........fbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbf.........
                ........fbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbf.........
                .......fbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbf........
                .......fbbbbbbbbbbbbbbbbffbbbbbbbffbbbbbbf........
                ......fbbbbbbbbbbbbbbbbbffbbbbbbbffbbbbbbbf.......
                ......fbbbbbbbbbbbbbbbbbffbbbbbbbffbbbbbbbf.......
                ......fbbbbbbbbbbbbbbbbbffbbbbbbbffbbbbbbbf.......
                ......fbbbbbbbbbbbbbbbbbffbbbbbbbffbbbbbbbf.......
                ......fbbbbbbbbbbbbbbbbbffbbbbbbbffbbbbbbbf.......
                ......fbbbbbbbbbbbbbbbbbffbbbbbbbffbbbbbbbf.......
                ......fbbbbbbbbbbbbbbbbbffbbbbbbbffbbbbbbbf.......
                ......fbbbbbbbbbbbbbbbbbffbbbbbbbffbbbbbbbf.......
                ......fbbbbbbbbbbbbbbbbbffbbbbbbbffbbbbbbbf.......
                ......fbbbbbbbbbbbbbbbbbffbbbbbbbffbbbbbbbf.......
                ......fbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbf.......
                ......fbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbf.......
                ......fbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbf.......
                .......fbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbf........
                .......fbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbf........
                ........fbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbf.........
                ........fbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbf.........
                .........fbbbbbbbbbbbbbbbbbbbbbbbbbbbbbf..........
                ..........fbbbbbbbbbbbbbbbbbbbbbbbbbbbf...........
                ...........fbbbbbbbbbbbbbbbbbbbbbbbbbf............
                ............fbbbbbbbbbbbbbbbbbbbbbbbf.............
                .............fbbbbbbbbbbbbbbbbbbbbbf..............
                ..............ffbbbbbbbbbbbbbbbbbff...............
                ................ffbbbbbbbbbbbbbff.................
                ..................fffffffffffff...................
                ..................................................
                ..................................................
            `, EnemyKind.Boss))
            tiles.placeOnTile(dango.entity, tiles_location[0])
            boss_num += 1
        }
        else if(level_ == 19)
        {
            dango = new dango_ch(sprites.create(img`
                ..................................................
                ..................fffffffffffff...................
                ................ff7777777777777ff.................
                ..............ff77777777777777777ff...............
                .............f777777777777777777777f..............
                ............f77777777777777777777777f.............
                ...........f7777777777777777777777777f............
                ..........f777777777777777777777777777f...........
                .........f77777777777777777777777777777f..........
                ........f7777777777777777777777777777777f.........
                ........f7777777777777777777777777777777f.........
                .......f777777777777777777777777777777777f........
                .......f7777777777777777ff7777777ff777777f........
                ......f77777777777777777ff7777777ff7777777f.......
                ......f77777777777777777ff7777777ff7777777f.......
                ......f77777777777777777ff7777777ff7777777f.......
                ......f77777777777777777ff7777777ff7777777f.......
                ......f77777777777777777ff7777777ff7777777f.......
                ......f77777777777777777ff7777777ff7777777f.......
                ......f77777777777777777ff7777777ff7777777f.......
                ......f77777777777777777ff7777777ff7777777f.......
                ......f77777777777777777ff7777777ff7777777f.......
                ......f77777777777777777ff7777777ff7777777f.......
                ......f77777777777777777777777777777777777f.......
                ......f77777777777777777777777777777777777f.......
                ......f77777777777777777777777777777777777f.......
                .......f777777777777777777777777777777777f........
                .......f777777777777777777777777777777777f........
                ........f7777777777777777777777777777777f.........
                ........f7777777777777777777777777777777f.........
                .........f77777777777777777777777777777f..........
                ..........f777777777777777777777777777f...........
                ...........f7777777777777777777777777f............
                ............f77777777777777777777777f.............
                .............f777777777777777777777f..............
                ..............ff77777777777777777ff...............
                ................ff7777777777777ff.................
                ..................fffffffffffff...................
                ..................................................
                ..................................................
            `, EnemyKind.Boss))
            tiles.placeOnTile(dango.entity, tiles_location[0])
            boss_num += 1
        }
        else if(level_ == 29)
        {
            dango = new dango_ch(sprites.create(img`
                ..................................................
                ..................fffffffffffff...................
                ................ff2222222222222ff.................
                ..............ff22222222222222222ff...............
                .............f222222222222222222222f..............
                ............f22222222222222222222222f.............
                ...........f2222222222222222222222222f............
                ..........f222222222222222222222222222f...........
                .........f22222222222222222222222222222f..........
                ........f2222222222222222222222222222222f.........
                ........f2222222222222222222222222222222f.........
                .......f222222222222222222222222222222222f........
                .......f2222222222222222ff2222222ff222222f........
                ......f22222222222222222ff2222222ff2222222f.......
                ......f22222222222222222ff2222222ff2222222f.......
                ......f22222222222222222ff2222222ff2222222f.......
                ......f22222222222222222ff2222222ff2222222f.......
                ......f22222222222222222ff2222222ff2222222f.......
                ......f22222222222222222ff2222222ff2222222f.......
                ......f22222222222222222ff2222222ff2222222f.......
                ......f22222222222222222ff2222222ff2222222f.......
                ......f22222222222222222ff2222222ff2222222f.......
                ......f22222222222222222ff2222222ff2222222f.......
                ......f22222222222222222222222222222222222f.......
                ......f22222222222222222222222222222222222f.......
                ......f22222222222222222222222222222222222f.......
                .......f222222222222222222222222222222222f........
                .......f222222222222222222222222222222222f........
                ........f2222222222222222222222222222222f.........
                ........f2222222222222222222222222222222f.........
                .........f22222222222222222222222222222f..........
                ..........f222222222222222222222222222f...........
                ...........f2222222222222222222222222f............
                ............f22222222222222222222222f.............
                .............f222222222222222222222f..............
                ..............ff22222222222222222ff...............
                ................ff2222222222222ff.................
                ..................fffffffffffff...................
                ..................................................
                ..................................................
            `, EnemyKind.Boss))
            tiles.placeOnTile(dango.entity, tiles_location[0])
            boss_num += 1
        }
        else if(level_ == 39)
        {
            dango = new dango_ch(sprites.create(img`
                ..................................................
                ..................fffffffffffff...................
                ................ff5555555555555ff.................
                ..............ff55555555555555555ff...............
                .............f555555555555555555555f..............
                ............f55555555555555555555555f.............
                ...........f5555555555555555555555555f............
                ..........f555555555555555555555555555f...........
                .........f55555555555555555555555555555f..........
                ........f5555555555555555555555555555555f.........
                ........f5555555555555555555555555555555f.........
                .......f555555555555555555555555555555555f........
                .......f5555555555555555ff5555555ff555555f........
                ......f55555555555555555ff5555555ff5555555f.......
                ......f55555555555555555ff5555555ff5555555f.......
                ......f55555555555555555ff5555555ff5555555f.......
                ......f55555555555555555ff5555555ff5555555f.......
                ......f55555555555555555ff5555555ff5555555f.......
                ......f55555555555555555ff5555555ff5555555f.......
                ......f55555555555555555ff5555555ff5555555f.......
                ......f55555555555555555ff5555555ff5555555f.......
                ......f55555555555555555ff5555555ff5555555f.......
                ......f55555555555555555ff5555555ff5555555f.......
                ......f55555555555555555555555555555555555f.......
                ......f55555555555555555555555555555555555f.......
                ......f55555555555555555555555555555555555f.......
                .......f555555555555555555555555555555555f........
                .......f555555555555555555555555555555555f........
                ........f5555555555555555555555555555555f.........
                ........f5555555555555555555555555555555f.........
                .........f55555555555555555555555555555f..........
                ..........f555555555555555555555555555f...........
                ...........f5555555555555555555555555f............
                ............f55555555555555555555555f.............
                .............f555555555555555555555f..............
                ..............ff55555555555555555ff...............
                ................ff5555555555555ff.................
                ..................fffffffffffff...................
                ..................................................
                ..................................................
            `, EnemyKind.Boss))
            tiles.placeOnTile(dango.entity, tiles_location[0])
            boss_num += 1
        }
        else if(level_ >= 40 && level_ <= 44)
        {
            dango = new dango_ch(sprites.create(img`
                ..................................................
                ..................fffffffffffff...................
                ................ff3333333333333ff.................
                ..............ff33333333333333333ff...............
                .............f333333333333333333333f..............
                ............f33333333333333333333333f.............
                ...........f3333333333333333333333333f............
                ..........f333333333333333333333333333f...........
                .........f33333333333333333333333333333f..........
                ........f3333333333333333333333333333333f.........
                ........f3333333333333333333333333333333f.........
                .......f333333333333333333333333333333333f........
                .......f3333333333333333ff3333333ff333333f........
                ......f33333333333333333ff3333333ff3333333f.......
                ......f33333333333333333ff3333333ff3333333f.......
                ......f33333333333333333ff3333333ff3333333f.......
                ......f33333333333333333ff3333333ff3333333f.......
                ......f33333333333333333ff3333333ff3333333f.......
                ......f33333333333333333ff3333333ff3333333f.......
                ......f33333333333333333ff3333333ff3333333f.......
                ......f33333333333333333ff3333333ff3333333f.......
                ......f33333333333333333ff3333333ff3333333f.......
                ......f33333333333333333ff3333333ff3333333f.......
                ......f33333333333333333333333333333333333f.......
                ......f33333333333333333333333333333333333f.......
                ......f33333333333333333333333333333333333f.......
                .......f333333333333333333333333333333333f........
                .......f333333333333333333333333333333333f........
                ........f3333333333333333333333333333333f.........
                ........f3333333333333333333333333333333f.........
                .........f33333333333333333333333333333f..........
                ..........f333333333333333333333333333f...........
                ...........f3333333333333333333333333f............
                ............f33333333333333333333333f.............
                .............f333333333333333333333f..............
                ..............ff33333333333333333ff...............
                ................ff3333333333333ff.................
                ..................fffffffffffff...................
                ..................................................
                ..................................................
            `, EnemyKind.Boss))
            tiles.placeOnTile(dango.entity, tiles_location[0])
            boss_num += 1
        }
        else if(level_ == 49)
        {
            dango = new dango_ch(sprites.create(img`
                ..................................................
                ..................fffffffffffff...................
                ................ff9999999999999ff.................
                ..............ff99999999999999999ff...............
                .............f999999999999999999999f..............
                ............f99999999999999999999999f.............
                ...........f9999999999999999999999999f............
                ..........f999999999999999999999999999f...........
                .........f99999999999999999999999999999f..........
                ........f9999999999999999999999999999999f.........
                ........f9999999999999999999999999999999f.........
                .......f999999999999999999999999999999999f........
                .......f9999999999999999ff9999999ff999999f........
                ......f99999999999999999ff9999999ff9999999f.......
                ......f99999999999999999ff9999999ff9999999f.......
                ......f99999999999999999ff9999999ff9999999f.......
                ......f99999999999999999ff9999999ff9999999f.......
                ......f99999999999999999ff9999999ff9999999f.......
                ......f99999999999999999ff9999999ff9999999f.......
                ......f99999999999999999ff9999999ff9999999f.......
                ......f99999999999999999ff9999999ff9999999f.......
                ......f99999999999999999ff9999999ff9999999f.......
                ......f99999999999999999ff9999999ff9999999f.......
                ......f99999999999999999999999999999999999f.......
                ......f99999999999999999999999999999999999f.......
                ......f99999999999999999999999999999999999f.......
                .......f999999999999999999999999999999999f........
                .......f999999999999999999999999999999999f........
                ........f9999999999999999999999999999999f.........
                ........f9999999999999999999999999999999f.........
                .........f99999999999999999999999999999f..........
                ..........f999999999999999999999999999f...........
                ...........f9999999999999999999999999f............
                ............f99999999999999999999999f.............
                .............f999999999999999999999f..............
                ..............ff99999999999999999ff...............
                ................ff9999999999999ff.................
                ..................fffffffffffff...................
                ..................................................
                ..................................................
            `, EnemyKind.Boss))
            tiles.placeOnTile(dango.entity, tiles_location[0])
            boss_num += 1
        }
        tiles.setTileAt(tiles_location[0], myTiles.tile9) // 9 คือว่าง 23 คือสีชมพู
        
        if(boss_num == 1)
        {
            dango.entity.setPosition(70, 96)
        }
    }
}
// **************************************






// *******************moving character*******************
function rowa_move(mainRunRight:any, mainRunLeft:any, mainIdle:any)
{
    //controll
    controller.right.onEvent(ControllerButtonEvent.Pressed,
    rowa.walk_right(mainRunRight,
                    mainRunRight.addAnimationFrame(img`
                        ................................
                        ...........ffffffff.............
                        .........ffffffffffff...........
                        ........ffffffffffffff..........
                        ........ffffffffffffff..........
                        ........ffffffff4444ff..........
                        .......ffffffff444444ff.........
                        .......fffffff444fff44f.........
                        .......fffffff4444ff44f.........
                        .......fffffff44444444f.........
                        .......fffffff44444444f.........
                        .......fffffff44444444f.........
                        .......fffffff444fff4f..........
                        .......fffffff4444444f..........
                        ........ffffff444444f...........
                        .........fffffffffff............
                        .........ffff.f44f..............
                        .........ffffffeeff.............
                        ..........ff.feeeef.............
                        ...........f.feee8f.............
                        .............feeeef.............
                        .............fe4eef.............
                        .............fe44ef.............
                        .............fe44ef.............
                        .............fffff5.............
                        ..............fbbf..............
                        ..............fbbf..............
                        ..............fbbf..............
                        ..............fbbf..............
                        ..............fbbf..............
                        ..............ffffff............
                        ..............feeeef............
                    `),
                    mainRunRight.addAnimationFrame(img`
                        .......ffffffff.......
                        .....ffffffffffff.....
                        ....ffffffffffffff....
                        ....ffffffffffffff....
                        ....ffffffff4444ff....
                        ...ffffffff444444ff...
                        ...fffffff444fff44f...
                        ...fffffff4444ff44f...
                        ...fffffff44444444f...
                        ...fffffff44444444f...
                        ...fffffff44444444f...
                        ...fffffff444fff4f....
                        ...fffffff4444444f....
                        ....ffffff444444f.....
                        .....fffffffffff......
                        .....ffff.f44f........
                        .....ffffffeeff.......
                        ......ff.feeeef.......
                        .......f.feee8f.......
                        .........feeeef.......
                        .........fe4eef.......
                        .........fe44ef.......
                        .........fe44ef.......
                        .........fffff5.......
                        .........fbbbff.......
                        ........ffbbfbf.......
                        ........fbbbfbbf......
                        ........fbbf.fbf......
                        ........fbbf.fbbf.....
                        ........ffffffffff....
                        ........feeeffeeef....
                    `)))
    controller.left.onEvent(ControllerButtonEvent.Pressed,
    rowa.walk_left( mainRunLeft,
                    mainRunLeft.addAnimationFrame(img`
                        ................................
                        .............ffffffff...........
                        ...........ffffffffffff.........
                        ..........ffffffffffffff........
                        ..........ffffffffffffff........
                        ..........ff4444ffffffff........
                        .........ff444444ffffffff.......
                        .........f44fff444fffffff.......
                        .........f44ff4444fffffff.......
                        .........f44444444fffffff.......
                        .........f44444444fffffff.......
                        .........f44444444fffffff.......
                        ..........f4fff444fffffff.......
                        ..........f4444444fffffff.......
                        ...........f444444ffffff........
                        ............fffffffffff.........
                        ..............f44f.ffff.........
                        .............ffeeffffff.........
                        .............feeeef.ff..........
                        .............f8eeef.f...........
                        .............feeeef.............
                        .............fee4ef.............
                        .............fe44ef.............
                        .............fe44ef.............
                        .............5fffff.............
                        ..............fbbf..............
                        ..............fbbf..............
                        ..............fbbf..............
                        ..............fbbf..............
                        ..............fbbf..............
                        ............ffffff..............
                        ............feeeef..............
                    `),
                    mainRunLeft.addAnimationFrame(img`
                        .......ffffffff.......
                        .....ffffffffffff.....
                        ....ffffffffffffff....
                        ....ffffffffffffff....
                        ....ff4444ffffffff....
                        ...ff444444ffffffff...
                        ...f44fff444fffffff...
                        ...f44ff4444fffffff...
                        ...f44444444fffffff...
                        ...f44444444fffffff...
                        ...f44444444fffffff...
                        ....f4fff444fffffff...
                        ....f4444444fffffff...
                        .....f444444ffffff....
                        ......fffffffffff.....
                        ........f44f.ffff.....
                        .......ffeeffffff.....
                        .......feeeef.ff......
                        .......f8eeef.f.......
                        .......feeeef.........
                        .......fee4ef.........
                        .......fe44ef.........
                        .......fe44ef.........
                        .......5fffff.........
                        .......ffbbbf.........
                        .......fbfbbff........
                        ......fbbfbbbf........
                        ......fbf.fbbf........
                        .....fbbf.fbbf........
                        ....ffffffffff........
                        ....feeeffeeef........
                    `)))

    controller.right.onEvent(ControllerButtonEvent.Released,
    rowa.idle(      mainIdle,
                    mainIdle.addAnimationFrame(img`
                        ................................
                        ...........ffffffff.............
                        .........ffffffffffff...........
                        ........ffffffffffffff..........
                        ........ffffff44444ffff.........
                        ........ffff44444444fff.........
                        .......ffff4444444444ff.........
                        .......fff44fff44fff44f.........
                        .......fff444ff444ff44f.........
                        .......fff444444444444f.........
                        .......fff444444444444f.........
                        .......ffff4444444444ff.........
                        .......fffff444fff44ff..........
                        .......ffffff444444ff...........
                        ........ffffff4444ff............
                        .........fff.ffffff.............
                        .........fff..f44f..............
                        .........fffffffffff............
                        ..........fffeeffeefff..........
                        ..........feeeeeeeeeef..........
                        ..........feefe88efeef..........
                        ..........feefee8efeef..........
                        ..........feefeeeefeef..........
                        ..........f44feeeef44f..........
                        ..........f44fff5ff44f..........
                        ...........f4fbbbbf4f...........
                        ............ffbbbbff............
                        .............fbbbbf.............
                        .............fbbfbf.............
                        .............fbbfbf.............
                        .............fffffff............
                        .............feeefeef...........
                    `)))
    controller.left.onEvent(ControllerButtonEvent.Released,
    rowa.idle(      mainIdle,
                    mainIdle.addAnimationFrame(img`
                        ................................
                        ...........ffffffff.............
                        .........ffffffffffff...........
                        ........ffffffffffffff..........
                        ........ffffff44444ffff.........
                        ........ffff44444444fff.........
                        .......ffff4444444444ff.........
                        .......fff44fff44fff44f.........
                        .......fff444ff444ff44f.........
                        .......fff444444444444f.........
                        .......fff444444444444f.........
                        .......ffff4444444444ff.........
                        .......fffff444fff44ff..........
                        .......ffffff444444ff...........
                        ........ffffff4444ff............
                        .........fff.ffffff.............
                        .........fff..f44f..............
                        .........fffffffffff............
                        ..........fffeeffeefff..........
                        ..........feeeeeeeeeef..........
                        ..........feefe88efeef..........
                        ..........feefee8efeef..........
                        ..........feefeeeefeef..........
                        ..........f44feeeef44f..........
                        ..........f44fff5ff44f..........
                        ...........f4fbbbbf4f...........
                        ............ffbbbbff............
                        .............fbbbbf.............
                        .............fbbfbf.............
                        .............fbbfbf.............
                        .............fffffff............
                        .............feeefeef...........
                    `)))
}

function jk_move()
{   
    let jk_array = sprites.allOfKind(SpriteKind.Enemy) // คือ array ของ jk ที่อยู่ในฉาก

    jkRunRight = animation.createAnimation(ActionKind_jk.moveRight, 200)
    jkRunLeft = animation.createAnimation(ActionKind_jk.moveLeft, 200)
    jkIdle = animation.createAnimation(ActionKind_jk.idle, 200)

    /*for(let enemy of jk_array)
    {
        if(level%10 <= 5)
        {
            if (Math.abs(enemy.x - rowa.entity.x) < 70)
            {
                if (enemy.x - rowa.entity.x < -5)
                {
                    enemy.vx = 10
                }
                else if (enemy.x - rowa.entity.x > 5)
                {
                    enemy.vx = -10
                }
                if (enemy.y - rowa.entity.y < -5)
                {
                    enemy.vy = 10
                }
                else if (enemy.y - rowa.entity.y > 5)
                {
                    enemy.vy = -10
                }
            }
            else
            {
                enemy.vx = 0
                enemy.vy = 0
            }
        }
        else
        {
            if (Math.abs(enemy.x - rowa.entity.x) < 70)
            {
                if (enemy.x - rowa.entity.x < -5)
                {
                    enemy.vx = 10*5
                }
                else if (enemy.x - rowa.entity.x > 5)
                {
                    enemy.vx = -10*5
                }
                if (enemy.y - rowa.entity.y < -5)
                {
                    enemy.vy = 10*5
                }
                else if (enemy.y - rowa.entity.y > 5)
                {
                    enemy.vy = -10*5
                }
            }
            else
            {
                enemy.vx = 0
                enemy.vy = 0
            }
        }
    }*/

    for(let enemy of jk_array_)
    {
        set_Action(enemy, ActionKind_jk.moveRight, ActionKind_jk.moveLeft, ActionKind_jk.idle)
        if(level%10 <= 5)
        {
            if (Math.abs(enemy.entity.x - rowa.entity.x) < 70)
            {
                if (enemy.entity.x - rowa.entity.x < -5)
                {
                    enemy.entity.vx = 10
                }
                else if (enemy.entity.x - rowa.entity.x > 5)
                {
                    enemy.entity.vx = -10
                }
                if (enemy.entity.y - rowa.entity.y < -5)
                {
                    enemy.entity.vy = 10
                }
                else if (enemy.entity.y - rowa.entity.y > 5)
                {
                    enemy.entity.vy = -10
                }
            }
            else
            {
                enemy.entity.vx = 0
                enemy.entity.vy = 0
            }
        }
        else
        {
            if (Math.abs(enemy.entity.x - rowa.entity.x) < 70)
            {
                if (enemy.entity.x - rowa.entity.x < -5)
                {
                    enemy.entity.vx = 10*5
                }
                else if (enemy.entity.x - rowa.entity.x > 5)
                {
                    enemy.entity.vx = -10*5
                }
                if (enemy.entity.y - rowa.entity.y < -5)
                {
                    enemy.entity.vy = 10*5
                }
                else if (enemy.entity.y - rowa.entity.y > 5)
                {
                    enemy.entity.vy = -10*5
                }
            }
            else
            {
                enemy.entity.vx = 0
                enemy.entity.vy = 0
            }
        }
        enemy.walk_right(jkRunRight,
                        jkRunRight.addAnimationFrame(img`
                                        ................................
                                        ................................
                                        ..........ff....................
                                        ...........ffffff...............
                                        ............f77ffff.............
                                        .............ffffff.............
                                        .............ff77ffff...........
                                        ...........fff7ff777ff..........
                                        ..........ff7f777ff77ffffffff...
                                        .........fffff777ff777777777ff..
                                        ............ff777777777777777f..
                                        ............ff77777ffffffffff...
                                        ..........ffff77777f............
                                        ........fff77f777ffff...........
                                        ........fff7ff777ff5ff......f...
                                        ..........fff77775555ffffffff...
                                        ...........ff77775555fbbbbbff...
                                        .........ffff77775555ffffffff...
                                        ........ff77f77775555f..........
                                        ........fffffff77ff5ff..........
                                        ...........fffffffffffffffff....
                                        ..........ffffaaafffaaaaaaa5f...
                                        .........ffaaaaaaaaaaaaaaaa5f...
                                        ........ffaaaaaaaaaaaaaaaffff...
                                        .dd.fffffffffffffffffffff222ff..
                                        .dd.ff999ff............ff222ff..
                                        .dd.fffffff.............fffff...
                                        ................................
                                        ................................
                                        ................................
                                        ................................
                                        ................................
                        `),
                        jkRunRight.addAnimationFrame(img`
                                        ................................
                                        ................................
                                        ..........ff....................
                                        ...........fffff................
                                        ............f77fff..............
                                        .............fff7f..............
                                        .............ff77fff............
                                        ...........fff7ff77ff...........
                                        ..........ff7f77ff77ffffffff....
                                        .........fffff77ff777777777ff...
                                        ............ff77777777777777f...
                                        ............ff7777ffffffffff....
                                        ..........ffff7777f.............
                                        ........fff77f777fff............
                                        ........fff7ff777f5ff......f....
                                        ..........fff777f555ffffffff....
                                        .........ffff777f555ffffffff....
                                        ........ff77f777f555f...........
                                        ........fffffff77f5ff...........
                                        ...........fffff7ffffffffff.....
                                        ..........ffffaafffaaaaaaa5f....
                                        ddd......ffaaaaaaaaaaaaaaa5f....
                                        d.d.....ffaaaaaaaaaaaaaaffff....
                                        d.d.ffffffffffffffffffff222ff...
                                        d.ddff999ff...........ff222ff...
                                        d.ddfffffff............fffff....
                                        dd..............................
                                        ................................
                                        ................................
                                        ................................
                                        ................................
                                        ................................
                        `),
                        jkRunRight.addAnimationFrame(img`
                                        ................................
                                        ................................
                                        ..........ff....................
                                        ...........fffff................
                                        ............f77fff..............
                                        .............fff7f..............
                                        .............ff77fff............
                                        ...........fff7ff77ff...........
                                        ..........ff7f77ff77ffffffff....
                                        .........fffff77ff777777777ff...
                                        ............ff77777777777777f...
                                        ............ff7777ffffffffff....
                                        ..........ffff7777f.............
                                        ........fff77f777fff............
                                        ........fff7ff777f5ff......f....
                                        ..........fff777f555ffffffff....
                                        ...........ff777f555fbbbbbff....
                                        .........ffff777f555ffffffff....
                                        ........ff77f777f555f...........
                                        ........fffffff77f5ff...........
                                        ...........fffff7ffffffffff.....
                                        dd........ffffaafffaaaaaaa5f....
                                        ddd......ffaaaaaaaaaaaaaaa5f....
                                        d.d.....ffaaaaaaaaaaaaaaffff....
                                        d.d.ffffffffffffffffffff222ff...
                                        d..dff999ff...........ff222ff...
                                        d..dfffffff............fffff....
                                        d..d............................
                                        dddd............................
                                        ................................
                                        ................................
                                        ................................
                        `))
    }


}
// **************************************





// *******************destroying character*******************
function destroy(Kind: Sprite[])
{
    for (let value of Kind)
    {
        value.destroy()
    }
}
// **************************************





// **************************************boss scene**************************************
function boss_scene(turn_: number)
{
    if(turn_ < 3)
    {
        info.startCountdown(3)
        check_input()

        //สร้างโรงงาน
        //dango.entity.say(choose_boss_game[0] + choose_boss_game[1] + choose_boss_game[2])
        
        for(let i=0; i<3; i++)
        {
            if(choose_boss_game != [] && boss_num == 1)
            {
                if(choose_boss_game[i] != get_input[i])
                {
                    game.over(false, effects.melt)
                }
            }
        }

        choose_boss_game = [boss_game[randint(0, 5)], boss_game[randint(0, 5)], boss_game[randint(0, 5)]]
        console.log(choose_boss_game[0] +" "+ choose_boss_game[1] +" "+ choose_boss_game[2])
        rowa.entity.say(choose_boss_game[0] +" "+ choose_boss_game[1] +" "+ choose_boss_game[2], 3000)
        turn += 1
    }
    else
    {
        turn = 0
        //สร้างโรงงาน
        console.log(choose_boss_game[0] +" "+ choose_boss_game[1] +" "+ choose_boss_game[2])
        //dango.entity.say(choose_boss_game[0] +" "+ choose_boss_game[1] +" "+ choose_boss_game[2], 3000)
        
        for(let i=0; i<3; i++)
        {
            if(choose_boss_game != [] && boss_num == 1)
            {
                if(choose_boss_game[i] != get_input[i])
                {
                    game.over(false, effects.melt)
                }
            }
        }

        let temp = rowa.next()
        temp()
    }

}

function check_input()
{
    // B
    controller.B.onEvent(ControllerButtonEvent.Pressed,rowa.push_B())

    // up&down
    controller.up.onEvent(ControllerButtonEvent.Pressed,rowa.up())
    controller.down.onEvent(ControllerButtonEvent.Pressed,rowa.down())
}
// **************************************



// **************************************check_position**************************************
function set_Action(entity_:any, action_right:any, action_left:any, action_idle:any)
{
    if (entity_.entity.vx > 0 && entity_.entity.vy == 0)
    {
        animation.setAction(entity_.entity, action_right)
    }
    else if (entity_.entity.vx < 0 && entity_.entity.vy == 0)
    {
        animation.setAction(entity_.entity, action_left)
    }
    else
    {
        animation.setAction(entity_.entity, action_idle)
    }
}
// **************************************




// start game
create_rowa() // สร้าง rowa
rowa_move(mainRunRight, mainRunLeft, mainIdle) // จัดการเกี่ยวกับการเคลื่อนไหวของ rowa
next_level() // จัดการเกี่ยวกับฉาก
//create_jk() // สร้างศัตรู
scene.onOverlapTile(SpriteKind.Player, myTiles.tile11, rowa.lose()) // ตกหลุมตาย
sprites.onOverlap(SpriteKind.Player, SpriteKind.Enemy, rowa.lose()) // โดน jk ตาย
scene.onOverlapTile(SpriteKind.Player, myTiles.tile4, rowa.next()) // เข้าเส้นชัยชนะ



// updating game
game.onUpdate(
function ()
{
    create_jk()
    jk_move()

    create_dango(level) 

    scene.centerCameraAt(rowa.entity.x, 0)
    /*if (rowa.entity.vx > 0 && rowa.entity.vy == 0)
    {
        animation.setAction(rowa.entity, ActionKind.MoveRight)
    }
    else if (rowa.entity.vx < 0 && rowa.entity.vy == 0)
    {
        animation.setAction(rowa.entity, ActionKind.MoveLeft)
    }
    else
    {
        animation.setAction(rowa.entity, ActionKind.Idle)
    }*/

    set_Action(rowa, ActionKind.MoveRight, ActionKind.MoveLeft, ActionKind.Idle)

    if(level%10 >= 6)
    {
        rowa.set_VELOCITY(160)
        rowa.set_JUMP(-200)
    }
    else
    {
        rowa.set_VELOCITY(rowa.VELOCITY)
        rowa.set_JUMP(rowa.JUMP)
    }

})



function enemy_location(input_array: tiles.Location[])
{
    let temp = []
    for(let jk_arr of input_array)
    {
        temp.push([jk_arr.x, jk_arr.y])
    }

    return temp
}
